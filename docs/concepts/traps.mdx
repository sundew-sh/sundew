---
title: "Traps"
description: "Sundew's trap modules serve deceptive content designed to attract and engage AI agents across multiple surfaces."
---

Traps are the outward-facing components of Sundew -- they define what visitors see and interact with. Each trap type targets a different surface that AI agents commonly interact with.

All traps are **persona-aware**: they read the deployment persona and adapt their behavior accordingly. No trap contains hardcoded response content.

## MCP Server Trap

The MCP (Model Context Protocol) server trap is Sundew's flagship. It serves a fully protocol-compliant MCP server that AI agents can discover and connect to.

### Why MCP?

MCP is becoming a standard protocol for AI agents to interact with external tools. An agent that discovers an MCP server will attempt to enumerate its tools and call them. This is a very high-signal interaction -- connecting via MCP protocol is a strong indicator of an AI agent.

### How It Works

The MCP server advertises a set of tools appropriate to the deployment persona:

**Fintech persona:**
| Tool | Description |
|------|-------------|
| `query_transactions` | Search and filter transaction records |
| `get_customer_profile` | Retrieve customer details and account info |
| `read_config` | Read application configuration (returns fake `.env` with canary API keys) |
| `execute_sql` | Run SQL queries against the database (returns fake result sets) |

**SaaS persona:**
| Tool | Description |
|------|-------------|
| `list_users` | List all users in the organization |
| `get_api_keys` | Retrieve API keys for service integrations |
| `read_logs` | Read recent application log entries |
| `deploy_service` | Trigger a service deployment |

**Healthcare persona:**
| Tool | Description |
|------|-------------|
| `search_patients` | Search patient records by name or ID |
| `get_medical_record` | Retrieve a patient's medical history |
| `list_appointments` | View upcoming appointments |
| `read_config` | Read system configuration |

### Protocol Compliance

The MCP server implements:
- Proper JSON-RPC message framing
- Capability negotiation during initialization
- Correct error codes and error response format
- Tool listing with detailed descriptions and input schemas
- Realistic response latency matching the persona's timing profile

### Canary Tokens

Every MCP tool response that contains "sensitive" data includes embedded canary tokens:
- API keys use reserved formats that are verifiably fake
- Email addresses use `.example.com` domains
- IP addresses use reserved ranges (RFC 5737)
- URLs point to documentation domains

These tokens let researchers track how far stolen data propagates.

## REST API Trap

The REST API trap serves HTTP endpoints that look like a real application's API.

### Endpoint Generation

Endpoint paths, response shapes, and field names all come from the persona:

| Persona | Endpoints |
|---------|-----------|
| Fintech | `/api/v2/transactions`, `/api/v2/accounts`, `/api/v2/customers` |
| SaaS | `/v1/users`, `/v1/organizations`, `/v1/projects` |
| Healthcare | `/rest/patients`, `/rest/records`, `/rest/appointments` |

### Features

**API Documentation** -- Every deployment includes interactive API docs at a persona-appropriate path:
- Express persona: `/docs`
- Django persona: `/api-docs`
- Spring persona: `/swagger-ui`

**Authentication** -- The auth endpoint accepts any credentials and returns a realistic token:

```bash
curl -X POST http://localhost:8080/api/v2/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "password": "anything"}'
```

```json
{
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "expires_in": 3600,
  "token_type": "Bearer"
}
```

This lets agents proceed deeper into the API, generating more fingerprinting signals.

**Realistic Responses** -- Data endpoints return pre-generated records with persona-appropriate fields, realistic pagination, and consistent data relationships.

**Error Responses** -- Invalid requests produce error responses matching the persona's error style:

```json
// verbose style
{
  "error": {
    "code": "INVALID_PARAMETER",
    "message": "The 'limit' parameter must be between 1 and 100",
    "details": { "parameter": "limit", "received": 500, "maximum": 100 }
  }
}

// terse style
{ "error": "invalid_limit" }

// structured style
{
  "status": 400,
  "title": "Bad Request",
  "detail": "Parameter 'limit' exceeds maximum value of 100"
}
```

### Response Headers

HTTP headers are shaped by the persona's `framework_fingerprint`:

```
# Express persona
X-Powered-By: Express
ETag: W/"2a3-8f7e6d5c"

# Django persona
X-Frame-Options: DENY
Vary: Accept, Cookie

# Spring persona
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
```

## AI Discovery Trap

Discovery endpoints serve files that AI agents and automated tools actively search for.

### /.well-known/ai-plugin.json

The AI plugin manifest advertises the honeypot as a plugin-compatible service:

```json
{
  "schema_version": "v1",
  "name_for_human": "Northvane Analytics API",
  "name_for_model": "northvane_analytics",
  "description_for_human": "Access financial data and analytics",
  "description_for_model": "Query transactions, accounts, and customer data for Northvane Analytics. Supports filtering, pagination, and aggregation.",
  "api": {
    "type": "openapi",
    "url": "https://api.northvane-analytics.com/openapi.json"
  },
  "auth": { "type": "service_http", "authorization_type": "bearer" }
}
```

### /.well-known/mcp.json

MCP server discovery document:

```json
{
  "name": "Northvane Analytics",
  "version": "1.0.0",
  "description": "Financial data and analytics platform",
  "transport": "stdio"
}
```

### /robots.txt

```
User-agent: *
Disallow: /api/v2/internal/
Disallow: /api/v2/admin/
Disallow: /.env

Sitemap: https://api.northvane-analytics.com/sitemap.xml
```

The disallowed paths are deliberately interesting -- agents that respect `robots.txt` see paths worth investigating, and agents that ignore it still reveal their behavior.

### /sitemap.xml

Lists all trap URLs in a standard sitemap format, helping crawlers and agents discover the full API surface.

### /openapi.json

A complete OpenAPI 3.1 specification describing every endpoint, request/response schema, and authentication method for this deployment.

## Adding Custom Traps

Sundew's trap system is modular. See the [Contributing Guide](/contributing) for instructions on adding new trap types (GraphQL, gRPC, WebSocket, SSH).

## Next Steps

<CardGroup cols={2}>
  <Card title="Fingerprinting" icon="fingerprint" href="/concepts/fingerprinting">
    How Sundew analyzes visitor behavior from trap interactions.
  </Card>
  <Card title="Configuration" icon="gear" href="/getting-started/configuration">
    Enable or disable individual trap modules.
  </Card>
</CardGroup>
