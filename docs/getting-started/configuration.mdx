---
title: "Configuration"
description: "Configure Sundew's traps, persona engine, LLM backend, logging, and storage."
---

All Sundew configuration lives in a single file: `sundew.yaml`. Sundew looks for this file in the current working directory, or you can specify a path with `--config`.

```bash
sundew serve --config /path/to/sundew.yaml
```

## Full Configuration Reference

```yaml
# Trap modules to enable
traps:
  mcp_server: true        # MCP protocol server
  rest_api: true           # Adaptive REST API with Swagger docs
  ai_discovery: true       # /.well-known/*, robots.txt, sitemap.xml

# Persona configuration
persona: auto              # auto | path to custom persona.yaml
# persona: ./my-persona.yaml

# LLM backend for persona generation (deploy-time only)
llm:
  provider: ollama         # ollama | anthropic | openai | none
  model: llama3            # model name for the chosen provider
  # api_key: ...           # set via environment variable instead

# Server settings
server:
  host: 0.0.0.0
  port: 8080

# Storage backend
storage:
  database: ./data/sundew.db       # SQLite database path
  log_file: ./data/events.jsonl    # Structured event log

# Logging
logging:
  level: info              # debug | info | warning | error
  output: stdout           # stdout | file | both
```

## Traps

Each trap module can be independently enabled or disabled.

### MCP Server

```yaml
traps:
  mcp_server: true
```

When enabled, Sundew serves a fully MCP-protocol-compliant server with tools shaped by the deployment persona. A fintech persona might offer `query_transactions` and `get_customer_profile`, while a SaaS persona offers `list_users` and `get_api_keys`.

This is the highest-signal trap -- connecting via MCP protocol is a very strong indicator of an AI agent.

### REST API

```yaml
traps:
  rest_api: true
```

Serves adaptive REST endpoints with realistic responses. Includes:
- Swagger/OpenAPI documentation at a persona-appropriate path
- Auth endpoint that accepts any credentials and returns a realistic token
- Data endpoints with persona-themed fake records
- Realistic error responses matching the persona's error style

### AI Discovery

```yaml
traps:
  ai_discovery: true
```

Serves discovery files that AI agents and crawlers look for:
- `/.well-known/ai-plugin.json` -- AI plugin manifest
- `/.well-known/mcp.json` -- MCP server discovery
- `/robots.txt` -- with disallow paths matching the persona's endpoints
- `/sitemap.xml` -- sitemap of trap URLs
- `/openapi.json` -- full OpenAPI spec for this deployment

## Persona

The persona controls how your Sundew deployment looks to visitors.

### Auto Mode

```yaml
persona: auto
```

Sundew generates a random persona on first run. If an LLM backend is configured, it uses the LLM to generate rich, contextually appropriate response templates. Without an LLM, it randomly selects from pre-built persona packs.

The generated persona is saved to `./data/persona.yaml` and reused on subsequent runs for consistency.

### Custom Persona

```yaml
persona: ./my-persona.yaml
```

Point to a hand-crafted persona file for targeted deployments:

```yaml
# my-persona.yaml
persona:
  company_name: "Meridian Health Systems"
  industry: "healthcare"
  api_style: "rest"
  framework_fingerprint: "django"
  error_style: "structured"
  auth_scheme: "oauth2"
  data_theme: "medical"
  response_latency_ms: [120, 500]
  server_header: "gunicorn/21.2.0"
  endpoint_prefix: "/rest/v1"
  seed: 294817
```

### Persona Fields

| Field | Description | Examples |
|-------|-------------|----------|
| `company_name` | Fake company identity | "Northvane Analytics", "Cedarpoint Health" |
| `industry` | Industry theme for data and tools | `fintech`, `healthcare`, `saas`, `e-commerce` |
| `api_style` | API architecture style | `rest`, `graphql`, `grpc-web` |
| `framework_fingerprint` | Framework to mimic in headers | `express`, `django`, `spring`, `rails` |
| `error_style` | Error response format | `verbose`, `terse`, `structured` |
| `auth_scheme` | Authentication mechanism | `bearer_jwt`, `api_key`, `basic`, `oauth2` |
| `data_theme` | Theme for fake data records | `financial`, `medical`, `users`, `retail` |
| `response_latency_ms` | Jitter range `[min, max]` | `[80, 350]`, `[200, 800]` |
| `server_header` | Server response header value | `nginx/1.24.0`, `Apache/2.4.57` |
| `endpoint_prefix` | URL prefix for API routes | `/api/v2`, `/v1`, `/rest` |
| `seed` | Deterministic seed for reproducibility | Any integer |

## LLM Backend

The LLM is used **only at deploy time** to generate response templates. During normal operation, Sundew serves pre-generated cached responses with zero LLM latency.

### Environment Variables

Set API keys via environment variables rather than in the config file:

```bash
# Anthropic
export ANTHROPIC_API_KEY=sk-ant-...

# OpenAI
export OPENAI_API_KEY=sk-...

# Ollama (no key needed, just ensure Ollama is running)
ollama serve
```

### Provider: none

```yaml
llm:
  provider: none
```

Uses pre-built persona packs only. Good for air-gapped environments or quick testing. Less variation between deployments.

## Storage

### SQLite Database

```yaml
storage:
  database: ./data/sundew.db
```

Stores captured sessions, fingerprinting scores, and classification results. Query with the CLI:

```bash
sundew query --last 10
sundew query --type ai_agent
sundew stats
```

### Event Log

```yaml
storage:
  log_file: ./data/events.jsonl
```

Append-only structured log of every request in JSON Lines format. Each line contains the full request details, fingerprinting signals, and session context.

## Logging

```yaml
logging:
  level: info    # debug for development, info for production
  output: stdout
```

Log levels:
- `debug` -- every request detail, fingerprinting calculation steps
- `info` -- session classifications, startup messages, significant events
- `warning` -- configuration issues, degraded operation
- `error` -- failures that affect operation

## Environment Variable Overrides

Any config value can be overridden with an environment variable prefixed with `SUNDEW_`:

```bash
SUNDEW_SERVER_PORT=9090 sundew serve
SUNDEW_LOG_LEVEL=debug sundew serve
SUNDEW_LLM_PROVIDER=anthropic sundew generate
```

## Next Steps

<CardGroup cols={2}>
  <Card title="How It Works" icon="diagram-project" href="/concepts/how-it-works">
    Understand the architecture behind Sundew.
  </Card>
  <Card title="Custom Personas" icon="masks-theater" href="/guides/custom-personas">
    Build targeted personas for specific research scenarios.
  </Card>
</CardGroup>
